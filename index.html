<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>レンタカー予約（デモ）</title>
  <style>
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;background:#f8f9fa;color:#222}
    .wrap{max-width:640px;margin:0 auto;padding:16px}
    h1{font-size:20px;font-weight:700;margin-bottom:16px}
    form{display:flex;flex-direction:column;gap:16px}
    label{font-weight:700;font-size:14px;margin-bottom:4px;display:block}
    input,button,select{font:inherit}
    input[type="text"],input[type="date"],input[type="tel"]{
      width:100%;padding:12px;border-radius:8px;border:1px solid #ccc;box-sizing:border-box
    }
    .dates{display:flex;align-items:flex-end;gap:8px}
    .dates .date-field{flex:1;display:flex;flex-direction:column}
    .dates span{flex:0 0 auto;font-weight:700;line-height:38px;padding:0 4px}
    .car-types{display:flex;gap:8px;flex-wrap:nowrap;justify-content:space-between}
    .car-type{
      flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;
      padding:8px;border:2px solid #ccc;border-radius:12px;cursor:pointer;
      font-weight:600;transition:.2s;background:#fff;text-align:center;position:relative;min-width:0
    }
    .car-type input{display:none}
    .car-type svg{width:28px;height:28px;margin-bottom:4px}
    .car-type.selected{border-color:#007bff;background:#e7f0ff}
    .stock{font-size:11px;color:#555;position:absolute;bottom:4px;right:6px}
    .checkbox{margin-right:8px}
    .options-section{border:1px solid #ccc;padding:12px;border-radius:8px;background:#fff}
    .options-section legend{font-weight:700;font-size:14px;margin-bottom:8px}
    .option-item{margin-bottom:6px}
    .estimate-section{border:1px solid #ccc;padding:12px;border-radius:8px;background:#fff}
    .estimate-section legend{font-weight:700;font-size:14px;margin-bottom:8px}
    #estimate{font-size:14px;color:#222;font-weight:700;margin-top:4px}
    button{padding:12px;border:none;border-radius:8px;font-weight:700;cursor:pointer}
    .btn-primary{background:#007bff;color:#fff;width:100%;margin-top:30px}
    .btn-secondary{background:#f3f3f3;color:#333}
    .result{margin-top:16px;padding:12px;border:1px solid #ccc;border-radius:8px;background:#fafafa;white-space:pre-wrap}
    .days-diff{font-size:13px;color:#555;margin-top:4px}
    .hidden-section{display:none}
    @media(max-width:480px){
      .car-types{gap:6px}
      .car-type{padding:6px}
      .dates{flex-direction:column;align-items:stretch}
      .dates span{display:none}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>レンタカー予約（デモ）</h1>
    <form id="bookingForm">
      <div class="dates">
        <div class="date-field">
          <label for="dateStart">ご利用開始日</label>
          <input id="dateStart" name="dateStart" type="date" required>
        </div>
        <span>〜</span>
        <div class="date-field">
          <label for="dateEnd">ご利用終了日</label>
          <input id="dateEnd" name="dateEnd" type="date" required>
        </div>
      </div>
      <div id="daysDiff" class="days-diff"></div>
      <div>
        <label>車種を選択</label>
        <div class="car-types">
          <label class="car-type"><input type="radio" name="carType" value="軽自動車">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h18v3H3v-3zm2-5h14a2 2 0 0 1 2 2v2H3V10a2 2 0 0 1 2-2z"/></svg>
            軽自動車（1日:5000円）<span class="stock" id="stock-k">残:5</span></label>
          <label class="car-type"><input type="radio" name="carType" value="普通車">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 11h16v5H4v-5zm2-4h12a2 2 0 0 1 2 2v2H4V9a2 2 0 0 1 2-2z"/></svg>
            普通車（1日:6600円）<span class="stock" id="stock-n">残:3</span></label>
          <label class="car-type"><input type="radio" name="carType" value="小型ミニバン">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M2 12h20v5H2v-5zm2-5h14l4 4v1H2V9a2 2 0 0 1 2-2z"/></svg>
            小型ミニバン（1日:8800円）<span class="stock" id="stock-m">残:2</span></label>
          <label class="car-type"><input type="radio" name="carType" value="大型ミニバン">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 10h18v7H3v-7zm2-4h14a2 2 0 0 1 2 2v2H3V8a2 2 0 0 1 2-2z"/></svg>
            大型ミニバン（1日:13000円）<span class="stock" id="stock-b">残:1</span></label>
        </div>
      </div>
      <fieldset class="options-section">
        <legend>オプション</legend>
        <div class="option-item">
          <label><input type="checkbox" id="optChild" name="optChild" class="checkbox">チャイルドシート（500円/日）</label>
        </div>
      </fieldset>
      <fieldset class="estimate-section">
        <legend>概算料金</legend>
        <div id="estimate">概算料金: 0円</div>
      </fieldset>
      <button type="button" id="showMoreBtn" class="btn-secondary">上記内容で予約する</button>
      <div id="moreFields" class="hidden-section">
        <div>
          <label for="name">お名前</label>
          <input id="name" name="name" type="text" required>
        </div>
        <div>
          <label for="zip">郵便番号</label>
          <input id="zip" name="zip" type="text" placeholder="123-4567" required>
        </div>
        <div>
          <label for="addrAuto">住所（自動入力）</label>
          <input id="addrAuto" name="addrAuto" type="text">
        </div>
        <div>
          <label for="addrMore">建物名・番地等</label>
          <input id="addrMore" name="addrMore" type="text">
        </div>
        <div>
          <label for="tel">携帯番号</label>
          <input id="tel" name="tel" type="tel" placeholder="090-1234-5678" required>
        </div>
        <button class="btn-primary" type="submit">予約内容を送信（デモ）</button>
      </div>
      <div id="result" class="result" style="display:none"></div>
    </form>
  </div>
  <script>
    // 車種選択の見た目反映
    document.querySelectorAll('.car-type input').forEach(radio=>{
      radio.addEventListener('change', e=>{
        document.querySelectorAll('.car-type').forEach(ct=>ct.classList.remove('selected'));
        e.target.closest('.car-type').classList.add('selected');
        updateEstimate();
      });
    });

    // 日付関連
    const startEl=document.getElementById('dateStart');
    const endEl=document.getElementById('dateEnd');
    const diffEl=document.getElementById('daysDiff');
    const estimateEl=document.getElementById('estimate');

    // 初期値を今日と翌日に設定
    const today=new Date();
    const yyyy=today.getFullYear();
    const mm=String(today.getMonth()+1).padStart(2,'0');
    const dd=String(today.getDate()).padStart(2,'0');
    startEl.value=`${yyyy}-${mm}-${dd}`;

    const tomorrow=new Date(today);
    tomorrow.setDate(tomorrow.getDate()+1);
    const mm2=String(tomorrow.getMonth()+1).padStart(2,'0');
    const dd2=String(tomorrow.getDate()).padStart(2,'0');
    endEl.value=`${tomorrow.getFullYear()}-${mm2}-${dd2}`;

    function updateConstraints(){
      if(startEl.value){
        endEl.min=startEl.value;
      }else{
        endEl.removeAttribute('min');
      }
      updateEstimate();
    }

    function getDays(){
      if(startEl.value && endEl.value){
        const s=new Date(startEl.value);
        const e=new Date(endEl.value);
        if(e>=s){
          return Math.ceil((e-s)/(1000*60*60*24))+1;
        }
      }
      return 0;
    }

    function updateEstimate(){
      const days=getDays();
      if(days>0){
        diffEl.textContent=`利用日数: ${days}日`;
      }else{
        diffEl.textContent='';
      }
      const car=document.querySelector('input[name="carType"]:checked');
      if(car){
        const type=car.value;
        const rates={"軽自動車":5000,"普通車":6600,"小型ミニバン":8800,"大型ミニバン":13000};
        let price=0;
        if(days>0){
          price=days*rates[type];
          if(document.getElementById('optChild').checked){
            price+=days*500;
          }
          estimateEl.textContent=`概算料金: ${price.toLocaleString()}円`;
        }else{
          estimateEl.textContent='概算料金: 0円';
        }
      }else{
        estimateEl.textContent='概算料金: 0円';
      }
    }

    startEl.addEventListener('change',updateConstraints);
    endEl.addEventListener('change',updateEstimate);
    document.getElementById('optChild').addEventListener('change',updateEstimate);

    // 「上記内容で予約する」ボタンで詳細欄表示
    document.getElementById('showMoreBtn').addEventListener('click',()=>{
      document.getElementById('moreFields').style.display='block';
      document.getElementById('showMoreBtn').style.display='none';
    });

    // 郵便番号入力で住所自動入力（簡易デモ）
    document.getElementById('zip').addEventListener('blur',()=>{
      const zip=document.getElementById('zip').value.replace(/[^0-9]/g,'');
      const addr=document.getElementById('addrAuto');
      if(zip.startsWith('100')){
        addr.value='東京都千代田区';
      }else if(zip.startsWith('150')){
        addr.value='東京都渋谷区';
      }else if(zip.startsWith('160')){
        addr.value='東京都新宿区';
      }else if(zip.startsWith('394')){
        addr.value='長野県諏訪市';
      }else{
        addr.value='';
      }
    });

    // フォーム送信
    const form=document.getElementById('bookingForm');
    form.addEventListener('submit',e=>{
      e.preventDefault();
      const data={
        startDate:form.dateStart.value,
        endDate:form.dateEnd.value,
        days:getDays(),
        carType:form.carType.value,
        name:form.name.value,
        zip:form.zip.value,
        address:form.addrAuto.value,
        addressDetail:form.addrMore.value,
        mobile:form.tel.value,
        childSeat:form.optChild.checked
      };
      document.getElementById('result').style.display='block';
      document.getElementById('result').textContent=JSON.stringify(data,null,2);
    });

    // 初期見積もり表示
    updateEstimate();
  </script>
</body>
</html>
